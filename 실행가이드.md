# BITalino Python API 실행 가이드

## 1. 필수 패키지 설치

### 방법 1: PyPI에서 설치 (권장)
```bash
pip install bitalino matplotlib
```

### 방법 2: 로컬에서 설치
```bash
# 프로젝트 폴더에서
pip install .
pip install matplotlib  # 시각화용
```

## 2. 프로그램 실행

### 2-1. 기본 예제 실행 (터미널 출력)
```bash
python samples/sample.py
```

**설명:**
- BITalino에서 5초간 데이터를 읽어서 터미널에 출력
- LED와 부저를 켜고 끄는 기능 포함

**출력 예시:**
```
[[  8   1   1   0   0 497   1   0   0   0   0]
 [  9   1   1   0   0 483   1   0   0   0   0]
 ...
```

### 2-2. 실시간 시각화 실행 (그래프)
```bash
python samples/visualize_sensors.py
```

**설명:**
- 실시간으로 움직이는 그래프 창이 열림
- 6개 센서 채널을 동시에 표시
- 창을 닫으면 자동으로 연결 종료

**주의사항:**
- `visualize_sensors.py` 파일의 10번째 줄에서 MAC 주소를 확인하세요:
  ```python
  macAddress = "98:D3:71:FE:50:80"  # 본인의 BITalino MAC 주소로 변경
  ```

### 2-3. Unity 연동 서버 실행
```bash
python bitalino_unity_server.py
```

**설명:**
- TCP 서버가 `127.0.0.1:5000`에서 실행됨
- Unity에서 START/STOP 명령을 보낼 수 있음
- 이벤트 로그는 `events_log.csv`에 저장됨

## 3. 설정 변경 방법

### MAC 주소 변경
각 예제 파일의 상단에서 MAC 주소를 변경하세요:
```python
macAddress = "98:D3:71:FE:50:80"  # 본인의 BITalino MAC 주소
```

### 샘플링 레이트 변경
```python
samplingRate = 1000  # 1, 10, 100, 1000 중 선택 가능
```

### 채널 선택
```python
acqChannels = [0, 1, 2, 3, 4, 5]  # A1~A6 모두 읽기
# 또는 특정 채널만: [0, 1]  # A1, A2만 읽기
```

### 센서 이름 변경 (visualize_sensors.py)
```python
sensor_labels = ["A1 (EMG)", "A2 (EDA)", "A3 (ECG)", "A4", "A5", "A6"]
```

## 4. 문제 해결

### 연결 오류
- BITalino가 켜져 있는지 확인
- MAC 주소가 정확한지 확인
- 블루투스가 활성화되어 있는지 확인

### matplotlib 오류
```bash
pip install matplotlib
```

### numpy 오류
```bash
pip install numpy
```

### PyBluez 오류 (Windows/Linux)
```bash
pip install PyBluez-bitalino
```

## 5. 데이터 구조 이해

BITalino에서 읽은 데이터는 다음과 같은 구조입니다:
```
[Sequence, D0, D1, D2, D3, A0, A1, A2, A3, A4, A5]
```

- **Sequence**: 샘플 순서 번호 (0~15 반복)
- **D0~D3**: 디지털 채널 (0 또는 1)
- **A0~A5**: 아날로그 채널 (0~1023, 10-bit)

## 6. 센서 채널 매핑

| 코드 채널 | BITalino 포트 | 일반적인 센서 |
|----------|-------------|-------------|
| 0 | A1 | EMG (근전도) |
| 1 | A2 | EDA (피부전도도) |
| 2 | A3 | ECG (심전도) |
| 3 | A4 | EEG (뇌파) |
| 4 | A5 | ACC (가속도) |
| 5 | A6 | LUX (조도) |

